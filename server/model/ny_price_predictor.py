# -*- coding: utf-8 -*-
"""NY-Price-Predictor.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1gMM2-t79Sk7G8AaY8ROsC6JYu6UcsEzf
"""

import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.ensemble import RandomForestRegressor

df = pd.read_csv("real_estate_data.csv")

df.head()

df.info()

df.isna().sum()

df.drop(["exterior_walls","roof"],inplace=True,axis=1)

df.shape

df.basement = df.basement.fillna(0)

df.head()

df.basement.unique()

df['age'] = df.apply(lambda x: x['tx_year'] - x['year_built'], axis=1 )

df.drop('property_type', 1, inplace=True)

x = df[["beds","baths","sqft","year_built","basement","tx_year","insurance"]]

train_X, test_X, train_y, test_y = train_test_split(x, df.tx_price, test_size=0.1, )

rrr = RandomForestRegressor(n_estimators=75)
rrr = rrr.fit(train_X, train_y)

rrr.score(test_X,test_y)

import joblib

joblib.dump(rrr,"ai.model")

